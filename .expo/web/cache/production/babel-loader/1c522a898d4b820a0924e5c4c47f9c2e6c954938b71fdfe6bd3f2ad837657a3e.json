{"ast":null,"code":"import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";import _toConsumableArray from\"@babel/runtime/helpers/toConsumableArray\";import React,{useState,useRef}from'react';function findBestSourceForSize(sources,size){var _map$sort$sort$0$sour,_ref,_ref$map$sort$sort$;return(_map$sort$sort$0$sour=(_ref=_toConsumableArray(sources||[]))==null?void 0:(_ref$map$sort$sort$=_ref.map(function(source){if(!size){return{source:source,penalty:0,covers:false};}var _ref2=typeof source==='object'?source:{width:null,height:null},width=_ref2.width,height=_ref2.height;if(width==null||height==null){return{source:source,penalty:0,covers:false};}if(width<size.width||height<size.height){return{source:source,penalty:Math.max(size.width-width,size.height-height),covers:false};}return{source:source,penalty:(width-size.width)*(height-size.height),covers:true};}).sort(function(a,b){return a.penalty-b.penalty;}).sort(function(a,b){return Number(b.covers)-Number(a.covers);})[0])==null?void 0:_ref$map$sort$sort$.source)!=null?_map$sort$sort$0$sour:null;}export default function useSourceSelection(sources){var _sources$length,_ref3;var sizeCalculation=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'live';var measurementCallback=arguments.length>2?arguments[2]:undefined;var hasMoreThanOneSource=((_sources$length=sources==null?void 0:sources.length)!=null?_sources$length:0)>1;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),size=_useState2[0],setSize=_useState2[1];var resizeObserver=useRef(null);React.useEffect(function(){return function(){var _resizeObserver$curre;(_resizeObserver$curre=resizeObserver.current)==null?void 0:_resizeObserver$curre.disconnect();};},[]);var containerRef=React.useCallback(function(element){if(!hasMoreThanOneSource&&!measurementCallback){return;}var rect=element==null?void 0:element.getBoundingClientRect();measurementCallback==null?void 0:measurementCallback(element,rect);setSize(rect);if(sizeCalculation==='live'){var _resizeObserver$curre2;(_resizeObserver$curre2=resizeObserver.current)==null?void 0:_resizeObserver$curre2.disconnect();if(!element){return;}resizeObserver.current=new ResizeObserver(function(entries){setSize(entries[0].contentRect);measurementCallback==null?void 0:measurementCallback(entries[0].target,entries[0].contentRect);});resizeObserver.current.observe(element);}},[hasMoreThanOneSource,sizeCalculation]);var bestSourceForSize=size!==undefined?findBestSourceForSize(sources,size):null;var source=(_ref3=hasMoreThanOneSource?bestSourceForSize:sources==null?void 0:sources[0])!=null?_ref3:null;return React.useMemo(function(){return{containerRef:containerRef,source:source};},[source]);}","map":{"version":3,"names":["React","useState","useRef","findBestSourceForSize","sources","size","_map$sort$sort$0$sour","_ref","_ref$map$sort$sort$","_toConsumableArray","map","source","penalty","covers","_ref2","width","height","Math","max","sort","a","b","Number","useSourceSelection","_sources$length","_ref3","sizeCalculation","arguments","length","undefined","measurementCallback","hasMoreThanOneSource","_useState","_useState2","_slicedToArray","setSize","resizeObserver","useEffect","_resizeObserver$curre","current","disconnect","containerRef","useCallback","element","rect","getBoundingClientRect","_resizeObserver$curre2","ResizeObserver","entries","contentRect","target","observe","bestSourceForSize","useMemo"],"sources":["/Users/mobileappteamdetrix/WorkSpace/PersonalWork/AppProjects/ReactNative/PersonalPortfolioSIte/profile/node_modules/expo-image/src/web/useSourceSelection.ts"],"sourcesContent":["import React, { useState, useRef } from 'react';\n\nimport { ImageProps, ImageSource } from '../Image.types';\n\nfunction findBestSourceForSize(\n  sources: ImageSource[] | undefined,\n  size: DOMRect | null\n): ImageSource | null {\n  return (\n    [...(sources || [])]\n      // look for the smallest image that's still larger then a container\n      ?.map((source) => {\n        if (!size) {\n          return { source, penalty: 0, covers: false };\n        }\n        const { width, height } =\n          typeof source === 'object' ? source : { width: null, height: null };\n        if (width == null || height == null) {\n          return { source, penalty: 0, covers: false };\n        }\n        if (width < size.width || height < size.height) {\n          return {\n            source,\n            penalty: Math.max(size.width - width, size.height - height),\n            covers: false,\n          };\n        }\n        return { source, penalty: (width - size.width) * (height - size.height), covers: true };\n      })\n      .sort((a, b) => a.penalty - b.penalty)\n      .sort((a, b) => Number(b.covers) - Number(a.covers))[0]?.source ?? null\n  );\n}\n\nexport default function useSourceSelection(\n  sources?: ImageSource[],\n  sizeCalculation: ImageProps['responsivePolicy'] = 'live',\n  measurementCallback?: (target: HTMLElement, size: DOMRect) => void\n) {\n  const hasMoreThanOneSource = (sources?.length ?? 0) > 1;\n  // null - not calculated yet, DOMRect - size available\n  const [size, setSize] = useState<null | DOMRect>(null);\n  const resizeObserver = useRef<ResizeObserver | null>(null);\n\n  React.useEffect(() => {\n    return () => {\n      resizeObserver.current?.disconnect();\n    };\n  }, []);\n\n  const containerRef = React.useCallback(\n    (element: HTMLDivElement) => {\n      if (!hasMoreThanOneSource && !measurementCallback) {\n        return;\n      }\n      const rect = element?.getBoundingClientRect();\n      measurementCallback?.(element, rect);\n      setSize(rect);\n\n      if (sizeCalculation === 'live') {\n        resizeObserver.current?.disconnect();\n        if (!element) {\n          return;\n        }\n        resizeObserver.current = new ResizeObserver((entries) => {\n          setSize(entries[0].contentRect);\n          measurementCallback?.(entries[0].target as any, entries[0].contentRect);\n        });\n        resizeObserver.current.observe(element);\n      }\n    },\n    [hasMoreThanOneSource, sizeCalculation]\n  );\n\n  const bestSourceForSize = size !== undefined ? findBestSourceForSize(sources, size) : null;\n  const source = (hasMoreThanOneSource ? bestSourceForSize : sources?.[0]) ?? null;\n\n  return React.useMemo(\n    () => ({\n      containerRef,\n      source,\n    }),\n    [source]\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}